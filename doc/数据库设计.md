# ç½‘ä¸Šèœè°±åˆ†äº«å¹³å°æ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ“˜ 1. æ•°æ®åº“æ¦‚è§ˆ

- **æ•°æ®åº“å**: `db_recipe_share`
- **å­—ç¬¦é›†**: `utf8mb4` (æ”¯æŒ Emoji è¡¨æƒ…ï¼Œé€‚ç”¨äºè¯„è®ºå’ŒèŠå¤©)
- **æ’åºè§„åˆ™**: `utf8mb4_unicode_ci`
- **è®¾è®¡ä¾æ®**:
  - åŸºäºé¡¹ç›®æ–‡æ¡£ä¸­çš„ä¸‰ç§è§’è‰²ï¼šæ¸¸å®¢ã€ç™»å½•ç”¨æˆ·ã€ç®¡ç†å‘˜ã€‚
  - åŸºäº API æ–‡æ¡£ä¸­çš„æ ¸å¿ƒæ¨¡å—ï¼šç”¨æˆ·ã€èœè°±ã€äº’åŠ¨ã€ç¤¾äº¤ã€åå°ç®¡ç†ã€‚

## ğŸ—ºï¸ 2. å®ä½“å…³ç³»å›¾ (ER ç®€è¿°)

ä¸ºäº†æ»¡è¶³ä¸šåŠ¡é€»è¾‘ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å®ä½“å…³ç³»ï¼š

1. **ç”¨æˆ· (User)**: æ ¸å¿ƒå®ä½“ï¼Œå…³è”å‘å¸ƒèœè°±ã€è¯„è®ºã€æ”¶è—ã€å…³æ³¨ã€æ¶ˆæ¯ã€‚
2. **èœè°± (Recipe)**: æ ¸å¿ƒèµ„äº§ï¼ŒåŒ…å«åŸºæœ¬ä¿¡æ¯ã€å¤šä¸ªæ­¥éª¤ã€å¤šä¸ªç”¨æ–™ã€‚
   - **ä¸€å¯¹å¤š**: ä¸€ä¸ªèœè°±åŒ…å«å¤šä¸ªç”¨æ–™ (`Ingredient`)ã€‚
   - **ä¸€å¯¹å¤š**: ä¸€ä¸ªèœè°±åŒ…å«å¤šä¸ªæ­¥éª¤ (`Step`)ã€‚
   - **å¤šå¯¹ä¸€**: èœè°±å±äºä¸€ä¸ªåˆ†ç±» (`Category`)ã€‚
3. **äº’åŠ¨ (Interaction)**:
   - **æ”¶è—**: å¤šå¯¹å¤šï¼ˆç”¨æˆ· <-> èœè°±ï¼‰ã€‚
   - **è¯„è®º**: ä¸€å¯¹å¤šï¼ˆç”¨æˆ· -> è¯„è®º -> èœè°±ï¼‰ã€‚
   - **å…³æ³¨**: å¤šå¯¹å¤šï¼ˆç”¨æˆ· <-> ç”¨æˆ·ï¼‰ã€‚
   - **æ¶ˆæ¯**: ä¸€å¯¹ä¸€ï¼ˆç”¨æˆ· -> æ¶ˆæ¯ -> ç”¨æˆ·ï¼‰ã€‚
4. **ERå›¾ï¼š**

```mermaid
erDiagram
    %% ç”¨æˆ·è¡¨
    SYS_USER {
        bigint id PK
        string username
        string nickname
        string role "admin/member"
        tinyint status "1:æ­£å¸¸ 0:å°ç¦"
    }

    %% èœè°±åˆ†ç±»è¡¨
    RECIPE_CATEGORY {
        int id PK
        string name
    }

    %% èœè°±ä¸»è¡¨
    RECIPE_INFO {
        bigint id PK
        bigint user_id FK
        int category_id FK
        string title
        tinyint status "0:å¾…å®¡æ ¸ 1:å‘å¸ƒ 2:é©³å›"
    }

    %% èœè°±ç”¨æ–™è¡¨
    RECIPE_INGREDIENT {
        bigint id PK
        bigint recipe_id FK
        string name
        string amount
    }

    %% èœè°±æ­¥éª¤è¡¨
    RECIPE_STEP {
        bigint id PK
        bigint recipe_id FK
        int step_no
        string description
    }

    %% è¯„è®ºè¡¨
    RECIPE_COMMENT {
        bigint id PK
        bigint recipe_id FK
        bigint user_id FK
        string content
    }

    %% æ”¶è—å…³è”è¡¨ (å¤šå¯¹å¤šä¸­é—´è¡¨)
    USER_FAVORITE {
        bigint id PK
        bigint user_id FK
        bigint recipe_id FK
    }

    %% å…³æ³¨å…³è”è¡¨ (å¤šå¯¹å¤šä¸­é—´è¡¨)
    USER_FOLLOW {
        bigint id PK
        bigint follower_id FK "å‘èµ·å…³æ³¨è€…"
        bigint followed_id FK "è¢«å…³æ³¨è€…"
    }

    %% ç§ä¿¡è¡¨
    SYS_MESSAGE {
        bigint id PK
        bigint sender_id FK "å‘é€è€…"
        bigint receiver_id FK "æ¥æ”¶è€…"
        string content
        tinyint is_read
    }

    %% --- å…³ç³»å®šä¹‰ ---

    %% ç”¨æˆ·ä¸èœè°±ï¼šä¸€å¯¹å¤š (ä¸€ä¸ªç”¨æˆ·å‘å¸ƒå¤šä¸ªèœè°±)
    SYS_USER ||--o{ RECIPE_INFO : "publishes"
    
    %% åˆ†ç±»ä¸èœè°±ï¼šä¸€å¯¹å¤š (ä¸€ä¸ªåˆ†ç±»åŒ…å«å¤šä¸ªèœè°±)
    RECIPE_CATEGORY ||--o{ RECIPE_INFO : "categorizes"

    %% èœè°±ä¸ç»„æˆéƒ¨åˆ†ï¼šä¸€å¯¹å¤š (ä¸€ä¸ªèœè°±æœ‰å¤šä¸ªç”¨æ–™/æ­¥éª¤)
    RECIPE_INFO ||--|{ RECIPE_INGREDIENT : "contains"
    RECIPE_INFO ||--|{ RECIPE_STEP : "has_steps"

    %% äº’åŠ¨ï¼šæ”¶è— (å¤šå¯¹å¤šï¼Œé€šè¿‡ä¸­é—´è¡¨)
    SYS_USER ||--o{ USER_FAVORITE : "collects"
    RECIPE_INFO ||--o{ USER_FAVORITE : "is_collected_by"

    %% äº’åŠ¨ï¼šè¯„è®º (ç”¨æˆ·å¯¹èœè°±)
    SYS_USER ||--o{ RECIPE_COMMENT : "writes"
    RECIPE_INFO ||--o{ RECIPE_COMMENT : "has_comments"

    %% ç¤¾äº¤ï¼šå…³æ³¨ (ç”¨æˆ·å…³æ³¨ç”¨æˆ·)
    SYS_USER ||--o{ USER_FOLLOW : "follows"

    %% ç¤¾äº¤ï¼šç§ä¿¡ (ç”¨æˆ·å‘ç»™ç”¨æˆ·)
    SYS_USER ||--o{ SYS_MESSAGE : "sends/receives"
```



------

## ğŸ—‚ï¸ 3. æ•°æ®è¡¨è¯¦ç»†è®¾è®¡

### 3.1 ç”¨æˆ·ç®¡ç†æ¨¡å—

#### è¡¨åï¼š`sys_user` (ç”¨æˆ·è¡¨)

ç”¨äºå­˜å‚¨ç®¡ç†å‘˜å’Œæ™®é€šç”¨æˆ·çš„ä¿¡æ¯ã€‚

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜                    | å¯¹åº” API å­—æ®µ |
| ------------- | -------- | ---- | ---- | ----------------------- | ------------- |
| `id`          | BIGINT   | 20   | âœ…    | ä¸»é”®ï¼Œè‡ªå¢              | `userId`      |
| `username`    | VARCHAR  | 50   | âœ…    | ç™»å½•è´¦å·ï¼Œå”¯ä¸€ç´¢å¼•      | `username`    |
| `password`    | VARCHAR  | 100  | âœ…    | åŠ å¯†åçš„å¯†ç  (BCrypt)   | -             |
| `nickname`    | VARCHAR  | 50   | âœ…    | ç”¨æˆ·æ˜µç§°                | `nickname`    |
| `avatar`      | VARCHAR  | 255  | âŒ    | å¤´åƒ URL                | `avatar`      |
| `intro`       | VARCHAR  | 200  | âŒ    | ä¸ªäººç®€ä»‹                | `intro`       |
| `role`        | VARCHAR  | 20   | âœ…    | è§’è‰²ï¼š`admin`, `member` | `role`        |
| `status`      | TINYINT  | 1    | âœ…    | çŠ¶æ€ï¼š1-æ­£å¸¸, 0-å°ç¦    | -             |
| `create_time` | DATETIME | -    | âœ…    | æ³¨å†Œæ—¶é—´                | -             |
| `update_time` | DATETIME | -    | âœ…    | æ›´æ–°æ—¶é—´                | -             |

> **è®¾è®¡å¤‡æ³¨**: å¯¹åº” API `POST /api/v1/users/register` å’Œ `PUT /api/v1/users/me`ã€‚

------

### 3.2 èœè°±æ ¸å¿ƒæ¨¡å—

#### è¡¨åï¼š`recipe_category` (èœè°±åˆ†ç±»è¡¨)

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜                      | å¯¹åº” API å­—æ®µ |
| ------------- | -------- | ---- | ---- | ------------------------- | ------------- |
| `id`          | INT      | 11   | âœ…    | ä¸»é”®ï¼Œè‡ªå¢                | `categoryId`  |
| `name`        | VARCHAR  | 50   | âœ…    | åˆ†ç±»åç§° (å¦‚: å·èœ, ç”œç‚¹) | `name`        |
| `sort_order`  | INT      | 4    | âŒ    | æ’åºä¼˜å…ˆçº§                | `sortOrder`   |
| `create_time` | DATETIME | -    | âœ…    | åˆ›å»ºæ—¶é—´                  | -             |



#### è¡¨åï¼š`recipe_info` (èœè°±ä¸»è¡¨)

å­˜å‚¨èœè°±çš„åŸºç¡€ä¿¡æ¯å’Œå®¡æ ¸çŠ¶æ€ã€‚

| å­—æ®µå          | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜                                 | å¯¹åº” API å­—æ®µ  |
| --------------- | -------- | ---- | ---- | ------------------------------------ | -------------- |
| `id`            | BIGINT   | 20   | âœ…    | ä¸»é”®ï¼Œè‡ªå¢                           | `id`           |
| `title`         | VARCHAR  | 100  | âœ…    | èœè°±æ ‡é¢˜                             | `title`        |
| `user_id`       | BIGINT   | 20   | âœ…    | å‘å¸ƒè€… ID (å¤–é”®)                     | `author.id`    |
| `category_id`   | INT      | 11   | âœ…    | åˆ†ç±» ID (å¤–é”®)                       | `categoryId`   |
| `cover_image`   | VARCHAR  | 255  | âœ…    | å°é¢å›¾ URL                           | `coverImage`   |
| `description`   | VARCHAR  | 500  | âŒ    | èœè°±ç®€ä»‹/å¿ƒå¾—                        | `description`  |
| `status`        | TINYINT  | 1    | âœ…    | **çŠ¶æ€**: 0-å¾…å®¡æ ¸, 1-å·²å‘å¸ƒ, 2-é©³å› | `status`       |
| `reject_reason` | VARCHAR  | 255  | âŒ    | å®¡æ ¸é©³å›åŸå›                          | `rejectReason` |
| `view_count`    | INT      | 11   | âœ…    | æµè§ˆé‡ï¼Œé»˜è®¤ä¸º 0                     | `viewCount`    |
| `create_time`   | DATETIME | -    | âœ…    | å‘å¸ƒæ—¶é—´                             | `publishTime`  |
| `update_time`   | DATETIME | -    | âœ…    | æ›´æ–°æ—¶é—´                             | -              |



> **è®¾è®¡å¤‡æ³¨**: `status` å­—æ®µä¸¥æ ¼å¯¹åº”é¡¹ç›®æ–‡æ¡£ä¸­çš„æµè½¬é€»è¾‘ã€‚

#### è¡¨åï¼š`recipe_ingredient` (èœè°±ç”¨æ–™è¡¨)

| å­—æ®µå       | ç±»å‹    | é•¿åº¦ | å¿…å¡« | è¯´æ˜                  | å¯¹åº” API å­—æ®µ          |
| ------------ | ------- | ---- | ---- | --------------------- | ---------------------- |
| `id`         | BIGINT  | 20   | âœ…    | ä¸»é”®                  | -                      |
| `recipe_id`  | BIGINT  | 20   | âœ…    | å…³è”èœè°± ID           | -                      |
| `name`       | VARCHAR | 50   | âœ…    | é£Ÿæåç§° (å¦‚: è±†è…)   | `ingredients[].name`   |
| `amount`     | VARCHAR | 50   | âœ…    | ç”¨é‡ (å¦‚: 500g, é€‚é‡) | `ingredients[].amount` |
| `sort_order` | INT     | 4    | âŒ    | æ’åº                  | -                      |



#### è¡¨åï¼š`recipe_step` (èœè°±æ­¥éª¤è¡¨)

| å­—æ®µå        | ç±»å‹    | é•¿åº¦ | å¿…å¡« | è¯´æ˜                  | å¯¹åº” API å­—æ®µ    |
| ------------- | ------- | ---- | ---- | --------------------- | ---------------- |
| `id`          | BIGINT  | 20   | âœ…    | ä¸»é”®                  | -                |
| `recipe_id`   | BIGINT  | 20   | âœ…    | å…³è”èœè°± ID           | -                |
| `step_no`     | INT     | 4    | âœ…    | æ­¥éª¤åºå· (1, 2, 3...) | `steps[].stepNo` |
| `description` | TEXT    | -    | âœ…    | æ­¥éª¤æ–‡å­—æè¿°          | `steps[].desc`   |
| `image_url`   | VARCHAR | 255  | âŒ    | æ­¥éª¤å›¾ URL            | `steps[].img`    |



------

### 3.3 äº’åŠ¨ä¸ç¤¾äº¤æ¨¡å—

#### è¡¨åï¼š`user_favorite` (æ”¶è—è¡¨)

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜     |
| ------------- | -------- | ---- | ---- | -------- |
| `id`          | BIGINT   | 20   | âœ…    | ä¸»é”®     |
| `user_id`     | BIGINT   | 20   | âœ…    | ç”¨æˆ· ID  |
| `recipe_id`   | BIGINT   | 20   | âœ…    | èœè°± ID  |
| `create_time` | DATETIME | -    | âœ…    | æ”¶è—æ—¶é—´ |

 

#### è¡¨åï¼š`recipe_comment` (è¯„è®ºè¡¨)

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜     | å¯¹åº” API å­—æ®µ |
| ------------- | -------- | ---- | ---- | -------- | ------------- |
| `id`          | BIGINT   | 20   | âœ…    | ä¸»é”®     | `commentId`   |
| `recipe_id`   | BIGINT   | 20   | âœ…    | å…³è”èœè°± | `recipeId`    |
| `user_id`     | BIGINT   | 20   | âœ…    | è¯„è®ºäºº   | -             |
| `content`     | VARCHAR  | 500  | âœ…    | è¯„è®ºå†…å®¹ | `content`     |
| `create_time` | DATETIME | -    | âœ…    | è¯„è®ºæ—¶é—´ | -             |

 

#### è¡¨åï¼š`user_follow` (å…³æ³¨è¡¨)

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜              |
| ------------- | -------- | ---- | ---- | ----------------- |
| `id`          | BIGINT   | 20   | âœ…    | ä¸»é”®              |
| `follower_id` | BIGINT   | 20   | âœ…    | å‘èµ·å…³æ³¨çš„äºº (æˆ‘) |
| `followed_id` | BIGINT   | 20   | âœ…    | è¢«å…³æ³¨çš„äºº (å¤§å¨) |
| `create_time` | DATETIME | -    | âœ…    | å…³æ³¨æ—¶é—´          |

 

#### è¡¨åï¼š`sys_message` (ç§ä¿¡è¡¨)

| å­—æ®µå        | ç±»å‹     | é•¿åº¦ | å¿…å¡« | è¯´æ˜                 |
| ------------- | -------- | ---- | ---- | -------------------- |
| `id`          | BIGINT   | 20   | âœ…    | ä¸»é”®                 |
| `sender_id`   | BIGINT   | 20   | âœ…    | å‘é€è€… ID            |
| `receiver_id` | BIGINT   | 20   | âœ…    | æ¥æ”¶è€… ID            |
| `content`     | TEXT     | -    | âœ…    | ç§ä¿¡å†…å®¹             |
| `is_read`     | TINYINT  | 1    | âœ…    | çŠ¶æ€: 0-æœªè¯», 1-å·²è¯» |
| `create_time` | DATETIME | -    | âœ…    | å‘é€æ—¶é—´             |

 

> **è®¾è®¡å¤‡æ³¨**: å¯¹åº”é¡¹ç›®æ–‡æ¡£ä¸­çš„â€œä¸€å¯¹ä¸€ç§èŠâ€åŠŸèƒ½ï¼Œé…åˆ WebSocket ä½¿ç”¨ã€‚

------

## ğŸ› ï¸ 4. å…³é”® SQL å»ºè¡¨è¯­å¥ (ç¤ºä¾‹)

ä»¥ä¸‹æ˜¯æ ¸å¿ƒè¡¨ `recipe_info` çš„å»ºè¡¨è¯­å¥ï¼Œå±•ç¤ºäº†å¦‚ä½•è½å®æ–‡æ¡£ä¸­çš„å®¡æ ¸çŠ¶æ€é€»è¾‘ï¼š

```SQL
/*
 * ç½‘ä¸Šèœè°±åˆ†äº«å¹³å°æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
 * æ•°æ®åº“: db_recipe_share
 * ç‰ˆæœ¬: 1.0
 */

-- 1. åˆ›å»ºå¹¶ä½¿ç”¨æ•°æ®åº“
CREATE DATABASE IF NOT EXISTS `db_recipe_share` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE `db_recipe_share`;

-- ==========================================
-- 1. ç”¨æˆ·ç®¡ç†æ¨¡å—
-- ==========================================

-- è¡¨ï¼šsys_user (ç”¨æˆ·è¡¨)
CREATE TABLE `sys_user` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `username` varchar(50) NOT NULL COMMENT 'ç™»å½•è´¦å·',
  `password` varchar(100) NOT NULL COMMENT 'åŠ å¯†å¯†ç ',
  `nickname` varchar(50) NOT NULL COMMENT 'ç”¨æˆ·æ˜µç§°',
  `avatar` varchar(255) DEFAULT NULL COMMENT 'å¤´åƒURL',
  `intro` varchar(200) DEFAULT NULL COMMENT 'ä¸ªäººç®€ä»‹',
  `role` varchar(20) NOT NULL DEFAULT 'member' COMMENT 'è§’è‰²: admin-ç®¡ç†å‘˜, member-æ™®é€šç”¨æˆ·',
  `status` tinyint(1) NOT NULL DEFAULT '1' COMMENT 'çŠ¶æ€: 1-æ­£å¸¸, 0-å°ç¦',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'æ³¨å†Œæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`) USING BTREE COMMENT 'è´¦å·å”¯ä¸€ç´¢å¼•'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·ä¿¡æ¯è¡¨';


-- ==========================================
-- 2. èœè°±æ ¸å¿ƒæ¨¡å—
-- ==========================================

-- è¡¨ï¼šrecipe_category (èœè°±åˆ†ç±»è¡¨)
CREATE TABLE `recipe_category` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `name` varchar(50) NOT NULL COMMENT 'åˆ†ç±»åç§°',
  `sort_order` int(4) DEFAULT '0' COMMENT 'æ’åºä¼˜å…ˆçº§',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èœè°±åˆ†ç±»è¡¨';

-- è¡¨ï¼šrecipe_info (èœè°±ä¸»è¡¨)
CREATE TABLE `recipe_info` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `title` varchar(100) NOT NULL COMMENT 'èœè°±æ ‡é¢˜',
  `user_id` bigint(20) NOT NULL COMMENT 'å‘å¸ƒè€…ID',
  `category_id` int(11) NOT NULL COMMENT 'åˆ†ç±»ID',
  `cover_image` varchar(255) NOT NULL COMMENT 'å°é¢å›¾URL',
  `description` varchar(500) DEFAULT NULL COMMENT 'èœè°±ç®€ä»‹/å¿ƒå¾—',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'çŠ¶æ€: 0-å¾…å®¡æ ¸, 1-å·²å‘å¸ƒ, 2-é©³å›',
  `reject_reason` varchar(255) DEFAULT NULL COMMENT 'å®¡æ ¸é©³å›åŸå› ',
  `view_count` int(11) DEFAULT '0' COMMENT 'æµè§ˆé‡',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_title` (`title`) COMMENT 'ç”¨äºæœç´¢'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èœè°±ä¿¡æ¯è¡¨';

-- è¡¨ï¼šrecipe_ingredient (èœè°±ç”¨æ–™è¡¨)
CREATE TABLE `recipe_ingredient` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `recipe_id` bigint(20) NOT NULL COMMENT 'å…³è”èœè°±ID',
  `name` varchar(50) NOT NULL COMMENT 'é£Ÿæåç§°',
  `amount` varchar(50) NOT NULL COMMENT 'ç”¨é‡',
  `sort_order` int(4) DEFAULT '0' COMMENT 'æ’åº',
  PRIMARY KEY (`id`),
  KEY `idx_recipe_id` (`recipe_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èœè°±ç”¨æ–™è¡¨';

-- è¡¨ï¼šrecipe_step (èœè°±æ­¥éª¤è¡¨)
CREATE TABLE `recipe_step` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `recipe_id` bigint(20) NOT NULL COMMENT 'å…³è”èœè°±ID',
  `step_no` int(4) NOT NULL COMMENT 'æ­¥éª¤åºå·',
  `description` text NOT NULL COMMENT 'æ­¥éª¤æè¿°',
  `image_url` varchar(255) DEFAULT NULL COMMENT 'æ­¥éª¤å›¾URL',
  PRIMARY KEY (`id`),
  KEY `idx_recipe_id` (`recipe_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èœè°±æ­¥éª¤è¡¨';


-- ==========================================
-- 3. äº’åŠ¨ä¸ç¤¾äº¤æ¨¡å—
-- ==========================================

-- è¡¨ï¼šuser_favorite (ç”¨æˆ·æ”¶è—è¡¨)
CREATE TABLE `user_favorite` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `user_id` bigint(20) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `recipe_id` bigint(20) NOT NULL COMMENT 'èœè°±ID',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'æ”¶è—æ—¶é—´',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_recipe` (`user_id`,`recipe_id`) COMMENT 'é˜²æ­¢é‡å¤æ”¶è—',
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·æ”¶è—è¡¨';

-- è¡¨ï¼šrecipe_comment (èœè°±è¯„è®ºè¡¨)
CREATE TABLE `recipe_comment` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `recipe_id` bigint(20) NOT NULL COMMENT 'èœè°±ID',
  `user_id` bigint(20) NOT NULL COMMENT 'è¯„è®ºè€…ID',
  `content` varchar(500) NOT NULL COMMENT 'è¯„è®ºå†…å®¹',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'è¯„è®ºæ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_recipe_id` (`recipe_id`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èœè°±è¯„è®ºè¡¨';

-- è¡¨ï¼šuser_follow (ç”¨æˆ·å…³æ³¨è¡¨)
CREATE TABLE `user_follow` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `follower_id` bigint(20) NOT NULL COMMENT 'å‘èµ·å…³æ³¨è€…ID',
  `followed_id` bigint(20) NOT NULL COMMENT 'è¢«å…³æ³¨è€…ID',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å…³æ³¨æ—¶é—´',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_follow_relation` (`follower_id`,`followed_id`) COMMENT 'é˜²æ­¢é‡å¤å…³æ³¨',
  KEY `idx_follower` (`follower_id`),
  KEY `idx_followed` (`followed_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·å…³æ³¨å…³ç³»è¡¨';

-- è¡¨ï¼šsys_message (ç§ä¿¡è¡¨)
CREATE TABLE `sys_message` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `sender_id` bigint(20) NOT NULL COMMENT 'å‘é€è€…ID',
  `receiver_id` bigint(20) NOT NULL COMMENT 'æ¥æ”¶è€…ID',
  `content` text NOT NULL COMMENT 'ç§ä¿¡å†…å®¹',
  `is_read` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'çŠ¶æ€: 0-æœªè¯», 1-å·²è¯»',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å‘é€æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_sender` (`sender_id`),
  KEY `idx_receiver` (`receiver_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç«™å†…ç§ä¿¡è¡¨';
```

## âš ï¸ 5. è®¾è®¡æ³¨æ„äº‹é¡¹

1. **æœç´¢ä¼˜åŒ–**: `recipe_info` è¡¨ä¸­çš„ `title` å­—æ®µå»ºè®®æ·»åŠ ç´¢å¼•ï¼Œä»¥æ”¯æŒ API æ–‡æ¡£ä¸­çš„ `/api/v1/recipes/search` æ¨¡ç³ŠæŸ¥è¯¢ã€‚
2. **æ•°æ®ä¸€è‡´æ€§**: åˆ é™¤èœè°±æ—¶ï¼Œå»ºè®®ä½¿ç”¨äº‹åŠ¡åŒæ—¶åˆ é™¤ `recipe_ingredient` å’Œ `recipe_step` ä¸­çš„å…³è”æ•°æ®ï¼Œæˆ–è€…åœ¨æ•°æ®åº“å±‚é¢è®¾ç½®å¤–é”®çº§è”åˆ é™¤ (`ON DELETE CASCADE`)ã€‚
3. **æ•æ„Ÿå­—æ®µ**: `sys_user` è¡¨ä¸­çš„ `password` å­—æ®µåœ¨ API è¿”å›æ—¶å¿…é¡»è¿‡æ»¤æ‰ï¼ˆDTO è½¬æ¢ï¼‰ï¼Œä¸¥ç¦è¿”å›ç»™å‰ç«¯ã€‚
4. **ç§ä¿¡æƒé™**: è™½ç„¶æ•°æ®åº“å…è®¸ä»»æ„ç”¨æˆ·é—´å‘é€æ¶ˆæ¯ï¼Œä½†æ ¹æ®é¡¹ç›®æ–‡æ¡£é€»è¾‘ï¼Œä¸šåŠ¡å±‚ä»£ç éœ€æ ¡éªŒ `user_follow` è¡¨ä¸­æ˜¯å¦å­˜åœ¨å…³æ³¨å…³ç³»ï¼Œæ‰å…è®¸æ’å…¥ `sys_message` æ•°æ®ã€‚