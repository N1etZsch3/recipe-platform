# 网上菜谱分享平台接口文档

作者：师徒四人行小组  
版本：1.0  
创建日期：<YYYY-MM-DD>  

## 修订历史版本

| 日期 | 版本 | 说明 | 作者 |
| --- | --- | --- | --- |
| <YYYY-MM-DD> | 1.0 | 初版 | 师徒四人行小组 |

## 1. 简介

本文档定义网上菜谱分享平台对外提供的接口规范与调用方法，覆盖用户端、管理端、通用能力与 WebSocket 通道。文档适用于前端、移动端或第三方系统进行接口对接与联调。

## 2. 接口规范

### 2.1 测试地址

- Base URL：`http://<HOST>:<PORT>/`

### 2.2 鉴权方法

- 认证方式：JWT Bearer Token。
- 请求头：`Authorization: Bearer <token>`。
- 游客可访问公开接口，登录用户与管理员需携带 Token。

### 2.3 幂等与限流

- 幂等接口需在请求头携带 `X-Idempotent-Token`。
- 幂等 Token 获取：`GET /api/v1/common/idempotent/token`（有效期 5 分钟）。
- 部分接口已启用限流（以 IP 或登录用户维度）。

### 2.4 文件上传

- 接口：`POST /api/v1/common/upload`。
- 内容类型：`multipart/form-data`。
- 单文件与单次请求限制 50MB。

### 2.5 通用请求头

| Header | 说明 | 必填 |
| --- | --- | --- |
| Authorization | JWT Token（`Bearer <token>`） | 登录/管理员接口必填 |
| X-Idempotent-Token | 幂等 Token | 需要幂等的接口必填 |
| Content-Type | `application/json` 或 `multipart/form-data` | 视接口而定 |

### 2.6 统一返回结构

```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {}
}
```

- `code`：业务状态码，成功为 `200`。
- `msg`：提示信息。
- `data`：返回数据，可能为对象、数组或 `null`。

### 2.7 分页返回结构（IPage）

```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "records": [],
    "total": 0,
    "size": 10,
    "current": 1,
    "pages": 0
  }
}
```

- `records`：分页数据列表。
- `total`：总记录数。
- `size`：每页条数。
- `current`：当前页。
- `pages`：总页数。

### 2.8 WebSocket

- 连接地址：`ws://<HOST>:<PORT>/ws?token=<JWT>`
- 连接成功后用于实时通知（评论/点赞/关注/私信/审核等）。

## 3. 接口请求详细

### 3.1 认证与用户

#### 3.1.1 获取图形验证码

- 功能描述：获取图形验证码。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/captcha`
- 权限：公开

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| captchaId | 验证码 ID | String |
| imageBase64 | 图片 Base64 | String |

返回示例：

```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "captchaId": "b3a4...",
    "imageBase64": "data:image/png;base64,..."
  }
}
```

#### 3.1.2 用户注册

- 功能描述：注册新用户（含验证码校验）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/users/register`
- 权限：公开

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| username | 账号 | String | 必填 |
| password | 密码 | String | 必填 |
| nickname | 昵称 | String | 必填 |
| captchaId | 验证码 ID | String | 必填 |
| captchaCode | 验证码 | String | 必填 |

请求示例：

```json
{
  "username": "test01",
  "password": "123456",
  "nickname": "小厨",
  "captchaId": "b3a4...",
  "captchaCode": "a9b2"
}
```

返回参数（data）：无

#### 3.1.3 用户登录

- 功能描述：登录并获取 Token。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/users/login`
- 权限：公开

请求字段：同注册。

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| token | JWT Token | String |
| userId | 用户 ID | Long |
| nickname | 昵称 | String |
| role | 角色 | String |
| avatar | 头像 URL | String |
| requireConfirm | 是否需要强制登录确认 | Boolean |
| message | 冲突提示信息 | String |

说明：当账号已在线时返回 `code=409`，`data.requireConfirm=true`。

#### 3.1.4 强制登录

- 功能描述：踢掉旧会话并重新登录。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/users/force-login`
- 权限：公开

请求字段：同登录。

返回参数（data）：同登录。

#### 3.1.5 获取当前用户信息

- 功能描述：获取当前登录用户资料。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/users/me`
- 权限：登录

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 用户 ID | Long |
| username | 账号 | String |
| nickname | 昵称 | String |
| avatar | 头像 | String |
| intro | 个人简介 | String |
| role | 角色 | String |
| status | 状态 | Integer |
| createTime | 创建时间 | String |
| updateTime | 更新时间 | String |

#### 3.1.6 修改个人资料

- 功能描述：更新昵称/头像/简介。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/users/me`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| nickname | 昵称 | String | 选填 |
| avatar | 头像 URL | String | 选填 |
| intro | 简介 | String | 选填 |

返回参数（data）：无

#### 3.1.7 修改密码

- 功能描述：修改登录密码。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/users/password`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| oldPassword | 旧密码 | String | 必填 |
| newPassword | 新密码 | String | 必填 |

返回参数（data）：无

#### 3.1.8 退出登录

- 功能描述：将当前 Token 加入黑名单。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/users/logout`
- 权限：登录

返回参数（data）：无

---

### 3.2 通用能力

#### 3.2.1 文件上传

- 功能描述：上传文件至 COS，返回可访问 URL。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/common/upload`
- 权限：登录
- Content-Type：`multipart/form-data`

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| file | 文件 | File | 必填 |

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| url | 文件访问地址 | String |

#### 3.2.2 获取幂等 Token

- 功能描述：获取幂等 Token（5 分钟有效）。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/common/idempotent/token`
- 权限：登录

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| token | 幂等 Token | String |

---

### 3.3 菜谱（公开）

#### 3.3.1 获取分类列表

- 功能描述：获取菜谱分类列表。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/recipes/categories`
- 权限：公开

返回参数（data）：分类数组

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 分类 ID | Integer |
| name | 分类名称 | String |
| sortOrder | 排序 | Integer |

#### 3.3.2 菜谱分页查询

- 功能描述：分页查询菜谱列表。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/recipes/list`
- 权限：公开

请求参数：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| page | 页码 | Integer | 选填，默认 1 |
| size | 每页条数 | Integer | 选填，默认 10 |
| categoryId | 分类 ID | Integer | 选填 |
| keyword | 关键字 | String | 选填 |
| sort | 排序（new/hot） | String | 选填 |
| authorId | 作者 ID | Long | 选填 |
| status | 状态 | Integer | 选填 |

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 菜谱 ID | Long |
| title | 标题 | String |
| authorId | 作者 ID | Long |
| authorName | 作者昵称 | String |
| authorAvatar | 作者头像 | String |
| categoryId | 分类 ID | Integer |
| categoryName | 分类名称 | String |
| coverImage | 封面图 | String |
| description | 简介 | String |
| status | 状态 | Integer |
| viewCount | 浏览量 | Integer |
| commentCount | 评论数 | Integer |
| favoriteCount | 收藏数 | Integer |
| createTime | 创建时间 | String |

#### 3.3.3 菜谱详情

- 功能描述：获取菜谱详情（含食材与步骤）。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/recipes/{id}`
- 权限：公开

路径参数：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 菜谱 ID | Long |

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 菜谱 ID | Long |
| title | 标题 | String |
| authorId | 作者 ID | Long |
| authorName | 作者昵称 | String |
| authorAvatar | 作者头像 | String |
| categoryId | 分类 ID | Integer |
| categoryName | 分类名称 | String |
| coverImage | 封面图 | String |
| description | 简介 | String |
| status | 状态 | Integer |
| rejectReason | 驳回原因 | String |
| viewCount | 浏览量 | Integer |
| commentCount | 评论数 | Integer |
| favoriteCount | 收藏数 | Integer |
| isFavorite | 是否收藏 | Boolean |
| isFollow | 是否关注作者 | Boolean |
| createTime | 创建时间 | String |
| ingredients | 食材列表 | Array |
| steps | 步骤列表 | Array |

ingredients 单项：`name`、`amount`、`sortOrder`  
steps 单项：`stepNo`、`description`、`imageUrl`

---

### 3.4 菜谱（登录用户）

#### 3.4.1 简化版发布菜谱

- 功能描述：前端简化表单发布菜谱（幂等）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/recipes`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| title | 标题 | String | 必填 |
| coverImage | 封面图 | String | 选填 |
| content | 内容 | String | 选填 |
| category | 分类名称 | String | 选填 |

返回参数（data）：无

#### 3.4.2 简化版更新菜谱

- 功能描述：更新简化菜谱。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/recipes`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| id | 菜谱 ID | Long | 必填 |
| title | 标题 | String | 必填 |
| coverImage | 封面图 | String | 选填 |
| content | 内容 | String | 选填 |
| category | 分类名称 | String | 选填 |

返回参数（data）：无

#### 3.4.3 下架菜谱

- 功能描述：将已发布菜谱下架为待审核状态。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/recipes/{id}/unpublish`
- 权限：登录

路径参数：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 菜谱 ID | Long |

返回参数（data）：无

#### 3.4.4 完整发布菜谱

- 功能描述：发布完整菜谱（含食材与步骤）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/my/recipes`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| title | 标题 | String | 必填 |
| categoryId | 分类 ID | Integer | 必填 |
| coverImage | 封面图 | String | 选填 |
| description | 简介 | String | 选填 |
| ingredients | 食材数组 | Array | 必填 |
| steps | 步骤数组 | Array | 必填 |

ingredients 单项：`name`(必填)、`amount`、`sortOrder`  
steps 单项：`stepNo`、`description`(必填)、`imageUrl`

#### 3.4.5 完整更新菜谱

- 功能描述：修改完整菜谱（重新进入待审核）。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/my/recipes`
- 权限：登录

请求字段：同 3.4.4，额外包含 `id`。

#### 3.4.6 删除菜谱

- 功能描述：删除我的菜谱。
- 接口方式：HTTP
- 请求方法：DELETE
- 接口地址：`/api/v1/my/recipes/{id}`
- 权限：登录

路径参数：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 菜谱 ID | Long |

返回参数（data）：无

---

### 3.5 互动与评论

#### 3.5.1 收藏/取消收藏

- 功能描述：收藏或取消收藏菜谱（toggle）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/interactions/favorite/{recipeId}`
- 权限：登录

路径参数：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| recipeId | 菜谱 ID | Long |

返回参数（data）：无

#### 3.5.2 我的收藏列表

- 功能描述：分页获取收藏菜谱。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/favorites`
- 权限：登录

请求参数：`page`、`size`

返回参数：分页数据，records 单项为 `RecipeDetailDTO`（同 3.3.2 字段）。

#### 3.5.3 发表评论/回复

- 功能描述：发表评论或回复评论（幂等+限流）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/interactions/comments`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| recipeId | 菜谱 ID | Long | 必填 |
| parentId | 父评论 ID | Long | 选填 |
| content | 评论内容 | String | 必填 |

返回参数（data）：无

#### 3.5.4 评论列表

- 功能描述：获取菜谱顶级评论列表。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/comments/{recipeId}`
- 权限：公开

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 评论 ID | Long |
| recipeId | 菜谱 ID | Long |
| userId | 用户 ID | Long |
| parentId | 父评论 ID | Long |
| nickname | 昵称 | String |
| avatar | 头像 | String |
| content | 内容 | String |
| likeCount | 点赞数 | Integer |
| isLiked | 是否已点赞 | Boolean |
| replyToNickname | 被回复用户 | String |
| replyCount | 回复总数 | Integer |
| replies | 回复预览 | Array |
| createTime | 创建时间 | String |

#### 3.5.5 回复列表

- 功能描述：获取指定评论的回复列表。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/comments/{parentId}/replies`
- 权限：公开

请求参数：`page`、`size`

返回参数：分页数据，records 单项为 `CommentVO`（同 3.5.4）。

#### 3.5.6 删除评论

- 功能描述：删除评论（评论作者或管理员）。
- 接口方式：HTTP
- 请求方法：DELETE
- 接口地址：`/api/v1/interactions/comments/{commentId}`
- 权限：登录

路径参数：`commentId`

返回参数（data）：无

#### 3.5.7 点赞/取消点赞评论

- 功能描述：点赞或取消点赞评论。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/interactions/comments/{commentId}/like`
- 权限：登录

路径参数：`commentId`

返回参数（data）：无

#### 3.5.8 我的评论列表

- 功能描述：分页获取我发布的评论与回复。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/my-comments`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 评论 ID | Long |
| content | 评论内容 | String |
| recipeId | 菜谱 ID | Long |
| recipeTitle | 菜谱标题 | String |
| recipeCoverImage | 菜谱封面 | String |
| likeCount | 点赞数 | Integer |
| replyCount | 回复数 | Integer |
| parentId | 父评论 ID | Long |
| parentContent | 父评论内容 | String |
| replyToUserName | 被回复用户 | String |
| createTime | 创建时间 | String |

#### 3.5.9 批量删除我的评论

- 功能描述：批量删除我的评论。
- 接口方式：HTTP
- 请求方法：DELETE
- 接口地址：`/api/v1/interactions/my-comments`
- 权限：登录

请求体：评论 ID 数组，如 `[1,2,3]`

返回参数（data）：无

#### 3.5.10 回复我的评论列表

- 功能描述：分页获取回复我的评论。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/replies-for-me`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 回复 ID | Long |
| content | 回复内容 | String |
| replyUserId | 回复者 ID | Long |
| replyUserName | 回复者昵称 | String |
| replyUserAvatar | 回复者头像 | String |
| myCommentId | 原评论 ID | Long |
| myCommentContent | 原评论内容 | String |
| recipeId | 菜谱 ID | Long |
| recipeTitle | 菜谱标题 | String |
| createTime | 创建时间 | String |

#### 3.5.11 收到的点赞列表

- 功能描述：获取收到的点赞（按评论聚合）。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/likes-for-me`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| commentId | 评论 ID | Long |
| commentContent | 评论内容 | String |
| recipeId | 菜谱 ID | Long |
| recipeTitle | 菜谱标题 | String |
| likeCount | 点赞数 | Integer |
| likers | 最近点赞者 | Array |
| latestLikeTime | 最近点赞时间 | String |

likers 单项：`userId`、`nickname`、`avatar`、`likeTime`

#### 3.5.12 评论点赞详情

- 功能描述：获取指定评论的点赞者详情。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/comments/{commentId}/likers`
- 权限：公开

请求参数：`page`、`size`

返回参数：分页数据，records 单项为 `CommentLikeVO.LikerInfo`。

#### 3.5.13 系统通知列表

- 功能描述：获取系统通知列表（当前实现返回空列表）。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/interactions/system-notifications`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 通知 ID | Long |
| type | 通知类型 | String |
| title | 标题 | String |
| content | 内容 | String |
| relatedId | 关联 ID | Long |
| read | 是否已读 | Boolean |
| createTime | 创建时间 | String |

---

### 3.6 社交与私信

#### 3.6.1 关注/取关

- 功能描述：关注或取消关注用户（toggle）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/social/follow/{userId}`
- 权限：登录

路径参数：`userId`

返回参数（data）：无

#### 3.6.2 我的关注列表

- 功能描述：分页获取我关注的用户。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/social/follows`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 用户 ID | Long |
| nickname | 昵称 | String |
| avatar | 头像 | String |
| intro | 简介 | String |
| isMutualFollow | 是否互关 | Boolean |
| isFollow | 是否已关注 | Boolean |

#### 3.6.3 我的粉丝列表

- 功能描述：分页获取我的粉丝。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/social/fans`
- 权限：登录

请求参数：`page`、`size`

返回参数：同 3.6.2。

#### 3.6.4 发送私信

- 功能描述：发送私信消息。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/social/messages`
- 权限：登录

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| receiverId | 接收者 ID | Long | 必填 |
| content | 内容 | String | 必填 |

返回参数（data）：无

#### 3.6.5 获取聊天记录

- 功能描述：分页获取与指定用户聊天记录。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/social/messages/{userId}`
- 权限：登录

请求参数：`page`、`size`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 消息 ID | Long |
| senderId | 发送者 ID | Long |
| senderName | 发送者昵称 | String |
| senderAvatar | 发送者头像 | String |
| receiverId | 接收者 ID | Long |
| content | 内容 | String |
| createTime | 创建时间 | String |
| isMe | 是否我发送 | Boolean |

#### 3.6.6 获取会话列表

- 功能描述：获取会话列表（含未读数与最后消息）。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/social/conversations`
- 权限：登录

返回参数（data 数组单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| userId | 对方用户 ID | Long |
| nickname | 对方昵称 | String |
| avatar | 对方头像 | String |
| lastMessage | 最后一条消息 | String |
| lastTime | 最后消息时间 | String |
| unreadCount | 未读数 | Integer |

#### 3.6.7 获取用户公开信息

- 功能描述：获取用户公开资料。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/social/user/{userId}`
- 权限：登录

返回参数（data）：同 3.6.2。

#### 3.6.8 标记消息已读

- 功能描述：将某个发送者的消息标记为已读。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/social/messages/read/{senderId}`
- 权限：登录

路径参数：`senderId`

返回参数（data）：无

---

### 3.7 管理后台

#### 3.7.1 管理员登录

- 功能描述：管理员登录。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/admin/login`
- 权限：公开

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| username | 账号 | String | 必填 |
| password | 密码 | String | 必填 |

返回参数（data）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| token | JWT Token | String |
| userId | 管理员 ID | Long |
| nickname | 昵称 | String |
| role | 角色 | String |
| avatar | 头像 | String |

#### 3.7.2 仪表盘统计

- 功能描述：获取后台统计面板数据。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/admin/dashboard`
- 权限：管理员

返回参数（data）：`DashboardDTO`，包含用户/菜谱/评论/分类统计、月度统计、活跃用户、最新动态等。

#### 3.7.3 待审核菜谱列表

- 功能描述：分页获取待审核菜谱。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/admin/recipes/audit`
- 权限：管理员

请求参数：`page`、`size`

返回参数：分页数据，records 单项为 `RecipeDetailDTO`。

#### 3.7.4 审核菜谱

- 功能描述：审核单个菜谱（通过/驳回）。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/admin/recipes/audit`
- 权限：管理员

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| recipeId | 菜谱 ID | Long | 必填 |
| action | pass/reject | String | 必填 |
| reason | 驳回原因 | String | 选填 |

返回参数（data）：无

#### 3.7.5 批量审核菜谱

- 功能描述：批量审核菜谱。
- 接口方式：HTTP
- 请求方法：POST
- 接口地址：`/api/v1/admin/recipes/batch/audit`
- 权限：管理员

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| ids | 菜谱 ID 列表 | Array<Long> | 必填 |
| action | pass/reject | String | 必填 |
| reason | 驳回原因 | String | 选填 |

返回参数（data）：无

#### 3.7.6 菜谱列表（全量）

- 功能描述：分页获取全量菜谱。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/admin/recipes`
- 权限：管理员

请求参数：`page`、`size`、`status`、`keyword`

返回参数：分页数据，records 单项为 `RecipeDetailDTO`。

#### 3.7.7 删除菜谱（后台）

- 功能描述：删除菜谱并清理关联数据。
- 接口方式：HTTP
- 请求方法：DELETE
- 接口地址：`/api/v1/admin/recipes/{id}`
- 权限：管理员

路径参数：`id`

返回参数（data）：无

#### 3.7.8 批量更新菜谱状态

- 功能描述：批量上架/下架或更新状态。
- 接口方式：HTTP
- 请求方法：PUT
- 接口地址：`/api/v1/admin/recipes/batch/status`
- 权限：管理员

请求字段：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| ids | 菜谱 ID 列表 | Array<Long> | 必填 |
| status | 状态 | Integer | 必填 |

返回参数（data）：无

#### 3.7.9 分类管理

- 分类列表：`GET /api/v1/admin/categories`
- 新增分类：`POST /api/v1/admin/categories`
- 更新分类：`PUT /api/v1/admin/categories/{id}`
- 删除分类：`DELETE /api/v1/admin/categories/{id}`

请求字段（新增/更新）：

| 参数名 | 说明 | 类型 | 约束 |
| --- | --- | --- | --- |
| name | 分类名称 | String | 必填 |
| sortOrder | 排序 | Integer | 选填 |

#### 3.7.10 用户管理

- 用户列表：`GET /api/v1/admin/users`
- 新增用户：`POST /api/v1/admin/users`
- 更新用户：`PUT /api/v1/admin/users/{id}`
- 修改用户状态：`PUT /api/v1/admin/users/{userId}/status`
- 批量修改状态：`PUT /api/v1/admin/users/batch/status`
- 用户在线状态：`GET /api/v1/admin/users/online?userIds=1,2`
- 踢用户下线：`POST /api/v1/admin/users/{userId}/kick`

用户列表请求参数：`page`、`size`、`keyword`、`role`、`sortBy`

用户对象字段（新增/更新）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| username | 账号 | String |
| password | 密码 | String |
| nickname | 昵称 | String |
| avatar | 头像 | String |
| intro | 简介 | String |
| role | 角色 | String |
| status | 状态 | Integer |

#### 3.7.11 评论管理

- 评论列表：`GET /api/v1/admin/comments`
- 删除评论：`DELETE /api/v1/admin/comments/{id}`

评论列表请求参数：`page`、`size`、`keyword`、`userId`、`recipeId`、`sortBy`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 评论 ID | Long |
| recipeId | 菜谱 ID | Long |
| recipeTitle | 菜谱标题 | String |
| userId | 用户 ID | Long |
| userNickname | 用户昵称 | String |
| userAvatar | 用户头像 | String |
| content | 评论内容 | String |
| createTime | 创建时间 | String |

#### 3.7.12 操作日志

- 功能描述：分页查询管理员操作日志。
- 接口方式：HTTP
- 请求方法：GET
- 接口地址：`/api/v1/admin/logs`
- 权限：管理员

请求参数：`page`、`size`、`operationType`、`adminId`、`startDate`、`endDate`

返回参数（records 单项）：

| 参数名 | 说明 | 类型 |
| --- | --- | --- |
| id | 日志 ID | Long |
| adminId | 管理员 ID | Long |
| adminName | 管理员昵称 | String |
| operationType | 操作类型 | String |
| operationTypeName | 操作类型名称 | String |
| targetType | 目标类型 | String |
| targetId | 目标 ID | Long |
| targetName | 目标名称 | String |
| detail | 详情 | String |
| ipAddress | IP 地址 | String |
| createTime | 创建时间 | String |

---

## 4. 返回码说明

| 返回码 | 说明 |
| --- | --- |
| 200 | 请求成功 |
| 400 | 参数错误/缺少参数 |
| 401 | 未认证或 Token 无效 |
| 403 | 权限不足 |
| 404 | 接口不存在 |
| 405 | 请求方法不支持 |
| 409 | 账号已在线（登录冲突） |
| 413 | 上传文件过大 |
| 500 | 系统内部错误 |

