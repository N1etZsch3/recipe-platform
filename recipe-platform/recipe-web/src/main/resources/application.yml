server:
  port: 8080
  tomcat:
    # 防止大文件上传失败时连接被强制断开，导致前端无法获取错误响应
    # 设置为 -1 表示不限制，让 Spring 的 multipart 配置生效
    max-swallow-size: -1

spring:
  application:
    name: recipe-platform
  main:
    allow-bean-definition-overriding: true
  servlet:
    multipart:
      # 单个文件最大 50MB
      max-file-size: 50MB
      # 单次请求总大小最大 50MB
      max-request-size: 50MB
      # 启用文件上传
      enabled: true
  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver
  
  # Redis Configuration
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD}
      database: ${REDIS_DB:0}
      timeout: 3000ms
      lettuce:
        pool:
          max-active: 8
          max-wait: -1ms
          max-idle: 8
          min-idle: 0
  cache:
    type: redis
    redis:
      time-to-live: 3600000
      cache-null-values: false

mybatis-plus:
  mapper-locations: classpath*:mapper/*.xml
  configuration:
    map-underscore-to-camel-case: true

# Actuator 健康检查
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized
  info:
    env:
      enabled: true

# 菜谱清理配置
recipe:
  cleanup:
    # 被驳回菜谱保留天数
    rejected-days: 30
    # 草稿菜谱保留天数
    draft-days: 90
